// Generated by CoffeeScript 1.4.0
(function() {
  var getBoardUrl, popen;

  getBoardUrl = function(name) {
    return "/board/" + name;
  };

  popen = function(url) {
    $('#popback').show();
    return $('#popen').fadeIn(100, function() {
      return $(this).animate({
        'width': '80%',
        'margin-left': '-40%'
      }, 300, function() {
        return $(this).load(url);
      });
    });
  };

  $('.board').each(function() {
    var bUrl, bd;
    bd = $(this).attr('board');
    if (bd) {
      bUrl = getBoardUrl($(this).attr('board'));
      $(this).load(bUrl);
      if (!$(this).attr('target-url')) {
        $(this).attr('target-url', bUrl);
      }
    }
    $(this).mouseenter(function() {
      if ($(this).hasClass('bp')) {
        return $(this).addClass('board-hover');
      }
    });
    return $(this).mouseleave(function() {
      return $(this).removeClass('board-hover');
    });
  });

  $('.bp').click(function() {
    var tUrl;
    if (tUrl = $(this).attr('target-url')) {
      return popen(tUrl);
    }
  });

  $(document).on('click', '#popback', function(e) {
    if (e.target.id === 'popback') {
      $('#popen').children('.bcon').fadeOut();
      return $('#popen').css({
        'width': '0',
        'margin-left': '0'
      }).fadeOut(500, function() {
        return $('#popback').hide();
      });
    }
  }).on('click', '#cmdAdd', function(e) {
    var cmd;
    cmd = $.trim($('#cmdInput').val());
    if (cmd === '') {
      return false;
    }
    return $.ajax({
      url: '/api/startjob',
      data: {
        cmd: cmd
      },
      type: 'get',
      dataType: 'json',
      success: function(d) {
        if (d.status === 1) {
          return $('#cmdInput').parent().parent().removeClass('error').addClass('success');
        } else {
          return $('#cmdInput').parent().parent().removeClass('success').addClass('error');
        }
      }
    });
  }).on('keydown', '#cmdInput', function(e) {
    if (e.which === 13) {
      return $('#cmdAdd').trigger('click');
    }
  });

}).call(this);
